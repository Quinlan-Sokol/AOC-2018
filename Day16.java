/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package adventofcode.pkg2018;

import java.io.File;
import java.io.FileNotFoundException;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.Collections;
import java.util.HashMap;
import java.util.HashSet;
import java.util.Map;
import java.util.Scanner;
import java.util.Set;

/**
 *
 * @author QDS
 */
public class Day16 {
    public static void main(String args[]) throws FileNotFoundException{
        Scanner s = new Scanner(new File("src/input16.txt"));
        int count = 0;
        ArrayList<Integer> regBefore = new ArrayList();
        ArrayList<Integer> regAfter = new ArrayList();
        ArrayList<Integer> input = new ArrayList();
        Map<Integer, Set<Integer>> map = new HashMap(){{for(int k = 0; k < 16; k++){put(k, new ArrayList());}}};
        
        while(s.hasNextLine()){
            String line = s.nextLine();
            if(line.equals("end"))break;
            if(line.contains("Before")){
                regBefore.clear();
                for(String str : line.split("\\[")[1].replace("]", "").split(", ")){
                    regBefore.add(Integer.parseInt(str));
                }
            }else if(line.contains("After")){
                regAfter.clear();
                for(String str : line.split("\\[")[1].replace("]", "").split(", ")){
                    regAfter.add(Integer.parseInt(str));
                }
            }else if(line.isEmpty()){
                int opcodes = 0;
                int A = input.get(1);
                int B = input.get(2);
                int C = input.get(3);
                int opNum = input.get(0);
                Set<Integer> list = new HashSet();
                
                for(int k = 0; k < 16; k++){
                    ArrayList<Integer> arr = new ArrayList(){{addAll(regBefore);}};
                    switch(k){
                        case 0://addr
                            arr.set(C, arr.get(A)+arr.get(B));
                            break;
                        case 1://addi
                            arr.set(C, arr.get(A)+B);
                            break;
                        case 2://mulr
                            arr.set(C, arr.get(A)*arr.get(B));
                            break;
                        case 3://muli
                            arr.set(C, arr.get(A)*B);
                            break;
                        case 4://banr
                            arr.set(C, arr.get(A)&arr.get(B));
                            break;
                        case 5://bani
                            arr.set(C, arr.get(A)&B);
                            break;
                        case 6://borr
                            arr.set(C, arr.get(A)|arr.get(B));
                            break;
                        case 7://bori
                            arr.set(C, arr.get(A)|B);
                            break;
                        case 8://setr
                            arr.set(C, arr.get(A));
                            break;
                        case 9://seti
                            arr.set(C, A);
                            break;
                        case 10://gtir
                            if(A > arr.get(B))
                                arr.set(C, 1);
                            else
                                arr.set(C, 0);
                            break;
                        case 11://gtri
                            if(arr.get(A) > B)
                                arr.set(C, 1);
                            else
                                arr.set(C, 0);
                            break;
                        case 12://gtrr
                            if(arr.get(A) > arr.get(B))
                                arr.set(C, 1);
                            else
                                arr.set(C, 0);
                            break;
                        case 13://eqir
                            if(A == arr.get(B))
                                arr.set(C, 1);
                            else
                                arr.set(C, 0);
                            break;
                        case 14://eqri
                            if(arr.get(A) == B)
                                arr.set(C, 1);
                            else
                                arr.set(C, 0);
                            break;
                        case 15://eqrr
                            if(arr.get(A) == arr.get(B))
                                arr.set(C, 1);
                            else
                                arr.set(C, 0);
                            break;
                    }
                    if(arr.toString().equals(regAfter.toString())){
                        opcodes++;
                        list.add(k);
                    }
                }
                list.addAll(map.get(opNum));
                map.put(opNum, list);
                if(opcodes >= 3){
                    count++;
                }
            }else{
                input.clear();
                for(String str : line.split(" ")){
                    input.add(Integer.parseInt(str));
                }
            }
        }
        s.close();
        
        //ArrayList<Integer> remove = new ArrayList(Arrays.asList(4,5,8,10,13,15,11,12,14,9,2,0,6,7));
        for(int key : map.keySet()){
            Set<Integer> arr = map.get(key);
            //arr.removeAll(remove);
            int max = -1;
            int code = -1;
            for(int k = 0; k < 16; k++){
                if(Collections.frequency(arr, k) > max){
                    max = Collections.frequency(arr, k);
                    code = k;
                }
            }
            //System.out.println("Opcode " + key + ": " + code);
            //System.out.println(key + ": " + arr);
        }
    
        String temp = "7 2 0 0\n" +
"11 0 2 0\n" +
"2 1 1 3\n" +
"7 0 0 2\n" +
"11 2 2 2\n" +
"13 0 3 2\n" +
"7 2 1 2\n" +
"9 1 2 1\n" +
"8 1 0 2\n" +
"2 3 1 3\n" +
"2 3 1 1\n" +
"14 0 1 3\n" +
"7 3 2 3\n" +
"7 3 1 3\n" +
"9 3 2 2\n" +
"8 2 0 0\n" +
"7 1 0 2\n" +
"11 2 2 2\n" +
"2 0 2 1\n" +
"2 0 0 3\n" +
"2 3 1 2\n" +
"7 2 1 2\n" +
"9 0 2 0\n" +
"8 0 2 1\n" +
"2 2 3 0\n" +
"2 3 2 3\n" +
"2 3 2 2\n" +
"0 0 2 2\n" +
"7 2 1 2\n" +
"7 2 2 2\n" +
"9 1 2 1\n" +
"8 1 3 0\n" +
"2 2 1 3\n" +
"2 1 2 1\n" +
"2 2 3 2\n" +
"15 1 3 3\n" +
"7 3 3 3\n" +
"9 3 0 0\n" +
"8 0 3 2\n" +
"2 3 1 1\n" +
"2 2 0 3\n" +
"2 1 3 0\n" +
"15 0 3 0\n" +
"7 0 2 0\n" +
"7 0 3 0\n" +
"9 2 0 2\n" +
"8 2 2 3\n" +
"2 2 1 0\n" +
"2 3 2 2\n" +
"7 1 0 1\n" +
"11 1 1 1\n" +
"0 0 2 1\n" +
"7 1 2 1\n" +
"9 1 3 3\n" +
"8 3 2 1\n" +
"7 1 0 3\n" +
"11 3 1 3\n" +
"13 0 3 3\n" +
"7 3 3 3\n" +
"9 1 3 1\n" +
"8 1 1 3\n" +
"7 0 0 2\n" +
"11 2 2 2\n" +
"2 3 1 0\n" +
"2 0 3 1\n" +
"14 2 0 0\n" +
"7 0 1 0\n" +
"9 0 3 3\n" +
"8 3 2 1\n" +
"2 1 2 0\n" +
"2 2 2 3\n" +
"2 0 2 2\n" +
"7 0 2 3\n" +
"7 3 3 3\n" +
"9 3 1 1\n" +
"8 1 1 0\n" +
"2 0 2 1\n" +
"7 1 0 3\n" +
"11 3 1 3\n" +
"11 3 1 1\n" +
"7 1 3 1\n" +
"9 1 0 0\n" +
"8 0 3 2\n" +
"2 1 2 0\n" +
"7 3 0 1\n" +
"11 1 0 1\n" +
"2 2 1 3\n" +
"11 0 1 1\n" +
"7 1 1 1\n" +
"7 1 1 1\n" +
"9 1 2 2\n" +
"7 1 0 0\n" +
"11 0 3 0\n" +
"2 1 3 1\n" +
"15 1 3 3\n" +
"7 3 1 3\n" +
"9 2 3 2\n" +
"8 2 3 3\n" +
"2 0 3 2\n" +
"1 0 2 2\n" +
"7 2 2 2\n" +
"7 2 2 2\n" +
"9 2 3 3\n" +
"2 2 3 0\n" +
"2 3 0 2\n" +
"2 2 2 1\n" +
"0 0 2 2\n" +
"7 2 2 2\n" +
"9 3 2 3\n" +
"7 3 0 0\n" +
"11 0 3 0\n" +
"7 2 0 2\n" +
"11 2 0 2\n" +
"0 2 0 0\n" +
"7 0 2 0\n" +
"9 3 0 3\n" +
"2 3 2 0\n" +
"2 3 3 1\n" +
"0 2 0 1\n" +
"7 1 2 1\n" +
"9 1 3 3\n" +
"8 3 3 1\n" +
"2 3 3 2\n" +
"2 3 0 3\n" +
"1 3 2 3\n" +
"7 3 3 3\n" +
"9 3 1 1\n" +
"2 1 3 3\n" +
"2 0 1 2\n" +
"9 3 3 2\n" +
"7 2 1 2\n" +
"9 2 1 1\n" +
"8 1 3 0\n" +
"7 2 0 3\n" +
"11 3 0 3\n" +
"7 1 0 2\n" +
"11 2 2 2\n" +
"2 2 1 1\n" +
"12 3 2 3\n" +
"7 3 3 3\n" +
"9 3 0 0\n" +
"8 0 2 2\n" +
"2 0 3 1\n" +
"7 1 0 0\n" +
"11 0 1 0\n" +
"2 1 1 3\n" +
"11 3 1 1\n" +
"7 1 3 1\n" +
"9 2 1 2\n" +
"7 0 0 0\n" +
"11 0 2 0\n" +
"2 3 2 1\n" +
"13 0 3 0\n" +
"7 0 2 0\n" +
"7 0 1 0\n" +
"9 2 0 2\n" +
"8 2 0 0\n" +
"2 1 2 1\n" +
"7 0 0 2\n" +
"11 2 2 2\n" +
"9 1 3 1\n" +
"7 1 2 1\n" +
"9 1 0 0\n" +
"8 0 1 1\n" +
"2 1 0 2\n" +
"2 2 2 3\n" +
"2 2 1 0\n" +
"10 0 3 2\n" +
"7 2 3 2\n" +
"7 2 1 2\n" +
"9 1 2 1\n" +
"8 1 3 2\n" +
"2 3 1 1\n" +
"2 3 2 3\n" +
"5 1 0 3\n" +
"7 3 3 3\n" +
"7 3 1 3\n" +
"9 2 3 2\n" +
"2 2 1 1\n" +
"2 2 0 3\n" +
"10 0 3 0\n" +
"7 0 3 0\n" +
"9 2 0 2\n" +
"8 2 3 0\n" +
"2 0 3 1\n" +
"2 2 0 2\n" +
"7 1 0 3\n" +
"11 3 0 3\n" +
"12 3 2 1\n" +
"7 1 2 1\n" +
"9 0 1 0\n" +
"8 0 3 1\n" +
"2 3 0 2\n" +
"2 2 2 0\n" +
"2 2 3 3\n" +
"6 0 2 3\n" +
"7 3 2 3\n" +
"9 3 1 1\n" +
"8 1 3 0\n" +
"2 3 1 3\n" +
"2 0 1 1\n" +
"1 3 2 1\n" +
"7 1 1 1\n" +
"9 1 0 0\n" +
"7 0 0 3\n" +
"11 3 0 3\n" +
"2 0 3 2\n" +
"2 3 2 1\n" +
"1 1 2 2\n" +
"7 2 1 2\n" +
"7 2 3 2\n" +
"9 2 0 0\n" +
"2 2 0 3\n" +
"2 0 0 1\n" +
"2 0 3 2\n" +
"4 2 3 3\n" +
"7 3 1 3\n" +
"9 3 0 0\n" +
"8 0 1 1\n" +
"2 2 3 2\n" +
"2 1 3 0\n" +
"2 0 1 3\n" +
"12 3 2 3\n" +
"7 3 3 3\n" +
"9 1 3 1\n" +
"8 1 3 3\n" +
"2 3 2 1\n" +
"2 3 1 0\n" +
"6 2 0 2\n" +
"7 2 3 2\n" +
"7 2 1 2\n" +
"9 3 2 3\n" +
"8 3 2 2\n" +
"2 1 3 3\n" +
"2 1 3 0\n" +
"9 0 0 1\n" +
"7 1 2 1\n" +
"7 1 3 1\n" +
"9 1 2 2\n" +
"2 2 2 0\n" +
"2 1 0 1\n" +
"2 0 0 3\n" +
"15 1 0 3\n" +
"7 3 3 3\n" +
"9 3 2 2\n" +
"8 2 1 1\n" +
"2 0 2 0\n" +
"7 0 0 3\n" +
"11 3 2 3\n" +
"7 0 0 2\n" +
"11 2 2 2\n" +
"2 3 2 2\n" +
"7 2 3 2\n" +
"9 1 2 1\n" +
"2 2 0 2\n" +
"7 2 0 3\n" +
"11 3 0 3\n" +
"2 3 2 0\n" +
"12 3 2 2\n" +
"7 2 3 2\n" +
"9 2 1 1\n" +
"8 1 0 0\n" +
"2 2 1 2\n" +
"7 3 0 1\n" +
"11 1 2 1\n" +
"12 3 2 1\n" +
"7 1 2 1\n" +
"7 1 1 1\n" +
"9 0 1 0\n" +
"8 0 0 1\n" +
"2 0 2 0\n" +
"12 3 2 2\n" +
"7 2 3 2\n" +
"7 2 3 2\n" +
"9 1 2 1\n" +
"2 1 1 2\n" +
"7 0 0 3\n" +
"11 3 2 3\n" +
"2 3 2 0\n" +
"1 0 2 3\n" +
"7 3 2 3\n" +
"9 1 3 1\n" +
"8 1 1 3\n" +
"2 3 2 2\n" +
"2 2 0 0\n" +
"2 3 1 1\n" +
"14 0 1 2\n" +
"7 2 3 2\n" +
"9 3 2 3\n" +
"8 3 0 1\n" +
"7 0 0 3\n" +
"11 3 0 3\n" +
"2 1 3 0\n" +
"7 3 0 2\n" +
"11 2 3 2\n" +
"4 3 2 0\n" +
"7 0 3 0\n" +
"9 0 1 1\n" +
"8 1 1 0\n" +
"2 2 2 3\n" +
"2 3 3 1\n" +
"1 1 2 2\n" +
"7 2 1 2\n" +
"9 2 0 0\n" +
"8 0 0 1\n" +
"2 3 1 2\n" +
"2 1 0 3\n" +
"2 3 1 0\n" +
"7 3 2 2\n" +
"7 2 1 2\n" +
"7 2 1 2\n" +
"9 2 1 1\n" +
"8 1 1 3\n" +
"2 1 3 0\n" +
"2 2 1 2\n" +
"2 2 2 1\n" +
"8 0 2 0\n" +
"7 0 2 0\n" +
"9 3 0 3\n" +
"8 3 1 0\n" +
"2 2 2 3\n" +
"2 1 2 1\n" +
"15 1 3 2\n" +
"7 2 2 2\n" +
"9 0 2 0\n" +
"2 3 1 2\n" +
"2 3 1 1\n" +
"5 1 3 1\n" +
"7 1 3 1\n" +
"9 0 1 0\n" +
"8 0 3 1\n" +
"2 0 3 2\n" +
"2 2 2 0\n" +
"10 0 3 3\n" +
"7 3 1 3\n" +
"7 3 1 3\n" +
"9 3 1 1\n" +
"8 1 3 0\n" +
"7 3 0 3\n" +
"11 3 0 3\n" +
"2 1 1 1\n" +
"2 2 2 2\n" +
"12 3 2 1\n" +
"7 1 1 1\n" +
"9 1 0 0\n" +
"8 0 3 2\n" +
"2 1 0 0\n" +
"2 3 1 3\n" +
"2 3 3 1\n" +
"9 0 0 0\n" +
"7 0 1 0\n" +
"9 0 2 2\n" +
"8 2 2 3\n" +
"2 2 0 1\n" +
"2 3 3 2\n" +
"2 2 2 0\n" +
"6 1 2 1\n" +
"7 1 3 1\n" +
"9 1 3 3\n" +
"2 1 3 0\n" +
"2 1 3 1\n" +
"7 1 2 2\n" +
"7 2 2 2\n" +
"9 3 2 3\n" +
"8 3 3 0\n" +
"2 0 2 3\n" +
"2 2 1 2\n" +
"3 2 3 2\n" +
"7 2 3 2\n" +
"7 2 2 2\n" +
"9 2 0 0\n" +
"8 0 3 1\n" +
"2 1 3 2\n" +
"7 3 0 3\n" +
"11 3 2 3\n" +
"2 2 0 0\n" +
"10 0 3 3\n" +
"7 3 3 3\n" +
"9 3 1 1\n" +
"8 1 1 3\n" +
"2 2 0 1\n" +
"7 0 0 2\n" +
"11 2 3 2\n" +
"2 1 1 0\n" +
"6 1 2 2\n" +
"7 2 1 2\n" +
"7 2 2 2\n" +
"9 2 3 3\n" +
"7 1 0 2\n" +
"11 2 0 2\n" +
"2 1 2 1\n" +
"7 0 2 2\n" +
"7 2 3 2\n" +
"9 2 3 3\n" +
"8 3 0 2\n" +
"2 1 1 3\n" +
"9 3 0 1\n" +
"7 1 3 1\n" +
"9 1 2 2\n" +
"2 2 2 3\n" +
"2 2 0 1\n" +
"7 1 0 0\n" +
"11 0 2 0\n" +
"3 1 3 1\n" +
"7 1 2 1\n" +
"7 1 1 1\n" +
"9 1 2 2\n" +
"8 2 2 0\n" +
"7 3 0 2\n" +
"11 2 2 2\n" +
"2 0 3 3\n" +
"2 3 2 1\n" +
"12 3 2 1\n" +
"7 1 1 1\n" +
"9 1 0 0\n" +
"8 0 2 3\n" +
"2 2 1 0\n" +
"2 3 0 2\n" +
"2 3 0 1\n" +
"2 2 1 0\n" +
"7 0 1 0\n" +
"9 3 0 3\n" +
"8 3 0 1\n" +
"7 1 0 2\n" +
"11 2 2 2\n" +
"2 0 2 0\n" +
"2 0 0 3\n" +
"12 3 2 3\n" +
"7 3 3 3\n" +
"9 3 1 1\n" +
"8 1 0 3\n" +
"2 1 1 0\n" +
"2 0 2 1\n" +
"8 0 2 0\n" +
"7 0 2 0\n" +
"9 0 3 3\n" +
"2 2 0 0\n" +
"2 1 2 1\n" +
"2 1 1 2\n" +
"15 1 0 2\n" +
"7 2 3 2\n" +
"9 2 3 3\n" +
"8 3 0 0\n" +
"7 0 0 1\n" +
"11 1 3 1\n" +
"2 3 2 3\n" +
"7 0 0 2\n" +
"11 2 1 2\n" +
"1 3 2 3\n" +
"7 3 3 3\n" +
"7 3 1 3\n" +
"9 0 3 0\n" +
"8 0 3 2\n" +
"2 0 2 1\n" +
"2 1 2 0\n" +
"7 3 0 3\n" +
"11 3 1 3\n" +
"11 0 1 1\n" +
"7 1 2 1\n" +
"9 1 2 2\n" +
"8 2 3 3\n" +
"2 3 3 1\n" +
"7 0 0 0\n" +
"11 0 0 0\n" +
"2 0 3 2\n" +
"2 2 1 1\n" +
"7 1 3 1\n" +
"9 1 3 3\n" +
"7 2 0 1\n" +
"11 1 3 1\n" +
"2 1 2 2\n" +
"1 1 2 2\n" +
"7 2 3 2\n" +
"9 2 3 3\n" +
"8 3 1 1\n" +
"7 3 0 0\n" +
"11 0 3 0\n" +
"2 2 3 2\n" +
"2 2 0 3\n" +
"3 2 3 2\n" +
"7 2 1 2\n" +
"9 1 2 1\n" +
"8 1 3 3\n" +
"2 2 2 0\n" +
"2 2 3 1\n" +
"2 3 2 2\n" +
"6 0 2 1\n" +
"7 1 3 1\n" +
"7 1 2 1\n" +
"9 3 1 3\n" +
"8 3 0 1\n" +
"2 3 3 3\n" +
"2 0 1 2\n" +
"2 0 1 0\n" +
"1 3 2 0\n" +
"7 0 1 0\n" +
"9 1 0 1\n" +
"7 0 0 0\n" +
"11 0 0 0\n" +
"2 1 2 3\n" +
"2 2 3 0\n" +
"7 0 2 0\n" +
"9 1 0 1\n" +
"2 2 0 0\n" +
"2 2 0 3\n" +
"2 1 2 2\n" +
"2 3 0 0\n" +
"7 0 2 0\n" +
"7 0 2 0\n" +
"9 0 1 1\n" +
"8 1 0 0\n" +
"2 1 2 3\n" +
"7 1 0 1\n" +
"11 1 1 1\n" +
"2 0 1 2\n" +
"9 3 3 1\n" +
"7 1 3 1\n" +
"7 1 3 1\n" +
"9 0 1 0\n" +
"7 2 0 2\n" +
"11 2 1 2\n" +
"7 2 0 1\n" +
"11 1 1 1\n" +
"7 0 0 3\n" +
"11 3 0 3\n" +
"2 3 1 3\n" +
"7 3 3 3\n" +
"9 3 0 0\n" +
"8 0 3 1\n" +
"2 0 0 3\n" +
"2 3 2 0\n" +
"2 3 2 2\n" +
"4 3 2 2\n" +
"7 2 1 2\n" +
"9 2 1 1\n" +
"8 1 0 3\n" +
"2 0 0 2\n" +
"7 3 0 1\n" +
"11 1 2 1\n" +
"7 3 0 0\n" +
"11 0 1 0\n" +
"7 0 2 0\n" +
"7 0 2 0\n" +
"9 0 3 3\n" +
"2 3 1 2\n" +
"2 2 3 0\n" +
"6 1 2 0\n" +
"7 0 1 0\n" +
"7 0 3 0\n" +
"9 0 3 3\n" +
"2 0 2 1\n" +
"2 1 1 0\n" +
"7 3 0 2\n" +
"11 2 2 2\n" +
"11 0 1 2\n" +
"7 2 3 2\n" +
"9 3 2 3\n" +
"8 3 2 1\n" +
"2 0 3 2\n" +
"2 2 0 3\n" +
"15 0 3 3\n" +
"7 3 3 3\n" +
"7 3 3 3\n" +
"9 1 3 1\n" +
"2 2 1 2\n" +
"2 0 1 3\n" +
"2 0 2 0\n" +
"3 2 3 0\n" +
"7 0 2 0\n" +
"9 0 1 1\n" +
"2 2 1 0\n" +
"7 2 0 2\n" +
"11 2 0 2\n" +
"2 1 2 3\n" +
"13 0 3 0\n" +
"7 0 2 0\n" +
"7 0 1 0\n" +
"9 1 0 1\n" +
"2 2 2 0\n" +
"2 3 3 2\n" +
"6 0 2 0\n" +
"7 0 2 0\n" +
"9 0 1 1\n" +
"8 1 3 3\n" +
"2 2 2 1\n" +
"2 0 3 2\n" +
"2 1 2 0\n" +
"7 0 2 1\n" +
"7 1 3 1\n" +
"9 3 1 3\n" +
"8 3 3 2\n" +
"2 3 3 3\n" +
"7 3 0 0\n" +
"11 0 3 0\n" +
"2 2 0 1\n" +
"6 1 0 3\n" +
"7 3 1 3\n" +
"9 3 2 2\n" +
"8 2 3 1\n" +
"2 2 2 3\n" +
"2 2 2 2\n" +
"2 1 2 0\n" +
"15 0 3 0\n" +
"7 0 1 0\n" +
"9 1 0 1\n" +
"8 1 1 2\n" +
"2 1 0 1\n" +
"2 1 0 3\n" +
"2 2 3 0\n" +
"15 3 0 0\n" +
"7 0 2 0\n" +
"9 2 0 2\n" +
"8 2 3 0\n" +
"2 2 0 3\n" +
"2 0 1 2\n" +
"7 1 2 2\n" +
"7 2 1 2\n" +
"9 2 0 0\n" +
"8 0 0 1\n" +
"2 3 2 2\n" +
"7 1 0 0\n" +
"11 0 1 0\n" +
"7 0 2 0\n" +
"7 0 3 0\n" +
"9 1 0 1\n" +
"8 1 2 0\n" +
"7 3 0 3\n" +
"11 3 0 3\n" +
"2 3 3 1\n" +
"4 3 2 1\n" +
"7 1 3 1\n" +
"9 0 1 0\n" +
"2 1 3 3\n" +
"2 0 3 2\n" +
"2 1 1 1\n" +
"9 1 3 3\n" +
"7 3 2 3\n" +
"9 3 0 0\n" +
"8 0 2 2\n" +
"2 2 1 0\n" +
"7 2 0 1\n" +
"11 1 3 1\n" +
"2 2 1 3\n" +
"14 0 1 3\n" +
"7 3 2 3\n" +
"7 3 2 3\n" +
"9 3 2 2\n" +
"8 2 0 1\n" +
"2 3 2 3\n" +
"2 3 2 2\n" +
"5 3 0 2\n" +
"7 2 3 2\n" +
"7 2 3 2\n" +
"9 1 2 1\n" +
"7 0 0 0\n" +
"11 0 1 0\n" +
"2 2 1 2\n" +
"7 3 0 3\n" +
"11 3 2 3\n" +
"3 2 3 2\n" +
"7 2 3 2\n" +
"9 2 1 1\n" +
"8 1 1 2\n" +
"2 1 1 3\n" +
"2 0 0 1\n" +
"9 3 0 1\n" +
"7 1 3 1\n" +
"9 1 2 2\n" +
"8 2 0 1\n" +
"2 2 3 2\n" +
"7 0 0 3\n" +
"11 3 2 3\n" +
"3 2 3 0\n" +
"7 0 3 0\n" +
"9 1 0 1\n" +
"2 0 1 3\n" +
"2 2 0 0\n" +
"3 2 3 0\n" +
"7 0 1 0\n" +
"9 0 1 1\n" +
"8 1 3 0\n" +
"2 3 3 2\n" +
"2 2 0 1\n" +
"2 3 3 3\n" +
"6 1 2 3\n" +
"7 3 3 3\n" +
"9 0 3 0\n" +
"8 0 0 1\n" +
"2 0 0 3\n" +
"2 0 3 0\n" +
"4 3 2 3\n" +
"7 3 3 3\n" +
"7 3 1 3\n" +
"9 1 3 1\n" +
"8 1 2 3\n" +
"2 2 1 1\n" +
"2 3 3 0\n" +
"6 1 2 2\n" +
"7 2 3 2\n" +
"9 2 3 3\n" +
"2 2 0 2\n" +
"7 1 0 0\n" +
"11 0 1 0\n" +
"2 1 0 1\n" +
"9 1 0 1\n" +
"7 1 2 1\n" +
"7 1 1 1\n" +
"9 1 3 3\n" +
"8 3 3 2\n" +
"2 1 3 3\n" +
"2 1 3 1\n" +
"7 3 0 0\n" +
"11 0 3 0\n" +
"2 3 1 0\n" +
"7 0 1 0\n" +
"9 0 2 2\n" +
"8 2 0 1\n" +
"7 3 0 0\n" +
"11 0 2 0\n" +
"2 1 2 2\n" +
"13 0 3 0\n" +
"7 0 2 0\n" +
"7 0 1 0\n" +
"9 1 0 1\n" +
"8 1 0 0\n" +
"7 1 0 1\n" +
"11 1 1 1\n" +
"2 0 0 3\n" +
"2 2 1 2\n" +
"12 3 2 2\n" +
"7 2 3 2\n" +
"9 0 2 0\n" +
"8 0 0 1\n" +
"2 3 1 2\n" +
"2 3 1 3\n" +
"2 1 2 0\n" +
"9 0 0 0\n" +
"7 0 3 0\n" +
"9 1 0 1\n" +
"2 1 0 3\n" +
"2 2 1 0\n" +
"2 2 3 2\n" +
"13 0 3 3\n" +
"7 3 1 3\n" +
"7 3 2 3\n" +
"9 1 3 1\n" +
"8 1 0 3\n" +
"2 0 2 1\n" +
"2 3 1 2\n" +
"0 0 2 0\n" +
"7 0 3 0\n" +
"7 0 2 0\n" +
"9 0 3 3\n" +
"8 3 0 2\n" +
"2 1 0 3\n" +
"2 0 0 0\n" +
"2 1 3 1\n" +
"2 3 1 1\n" +
"7 1 1 1\n" +
"9 2 1 2\n" +
"8 2 0 0\n" +
"2 3 1 2\n" +
"7 2 0 1\n" +
"11 1 1 1\n" +
"7 3 2 1\n" +
"7 1 1 1\n" +
"9 1 0 0\n" +
"8 0 1 2\n" +
"7 1 0 1\n" +
"11 1 3 1\n" +
"2 2 3 0\n" +
"2 0 1 3\n" +
"2 3 0 0\n" +
"7 0 1 0\n" +
"9 0 2 2\n" +
"8 2 2 1\n" +
"2 1 2 0\n" +
"7 2 0 3\n" +
"11 3 1 3\n" +
"2 1 1 2\n" +
"9 3 0 3\n" +
"7 3 3 3\n" +
"7 3 1 3\n" +
"9 1 3 1\n" +
"7 3 0 3\n" +
"11 3 0 3\n" +
"2 0 0 2\n" +
"2 3 3 0\n" +
"0 2 0 2\n" +
"7 2 2 2\n" +
"7 2 3 2\n" +
"9 1 2 1\n" +
"8 1 3 0\n" +
"2 3 3 2\n" +
"2 0 0 1\n" +
"7 2 0 3\n" +
"11 3 1 3\n" +
"11 3 1 1\n" +
"7 1 3 1\n" +
"7 1 3 1\n" +
"9 1 0 0\n" +
"7 2 0 3\n" +
"11 3 2 3\n" +
"2 3 0 1\n" +
"7 2 0 2\n" +
"11 2 2 2\n" +
"14 2 1 1\n" +
"7 1 1 1\n" +
"9 1 0 0\n" +
"8 0 2 1\n" +
"7 0 0 0\n" +
"11 0 2 0\n" +
"2 3 3 2\n" +
"2 1 2 3\n" +
"7 3 2 2\n" +
"7 2 2 2\n" +
"9 2 1 1\n" +
"8 1 0 0\n" +
"2 1 3 1\n" +
"2 3 3 2\n" +
"2 2 3 3\n" +
"15 1 3 1\n" +
"7 1 3 1\n" +
"9 0 1 0\n" +
"8 0 1 1\n" +
"2 0 1 2\n" +
"2 2 0 0\n" +
"10 0 3 2\n" +
"7 2 2 2\n" +
"9 2 1 1\n" +
"8 1 1 2\n" +
"7 2 0 0\n" +
"11 0 3 0\n" +
"2 0 2 3\n" +
"7 1 0 1\n" +
"11 1 2 1\n" +
"6 1 0 3\n" +
"7 3 2 3\n" +
"9 2 3 2\n" +
"2 1 3 0\n" +
"2 1 1 1\n" +
"7 2 0 3\n" +
"11 3 2 3\n" +
"15 1 3 3\n" +
"7 3 3 3\n" +
"7 3 1 3\n" +
"9 3 2 2\n" +
"8 2 2 3\n" +
"7 2 0 2\n" +
"11 2 0 2\n" +
"2 0 3 1\n" +
"7 0 2 2\n" +
"7 2 1 2\n" +
"9 2 3 3\n" +
"8 3 1 2\n" +
"7 3 0 0\n" +
"11 0 2 0\n" +
"2 0 1 3\n" +
"3 0 3 1\n" +
"7 1 1 1\n" +
"9 2 1 2\n" +
"8 2 0 1\n" +
"2 1 2 3\n" +
"2 2 2 2\n" +
"13 0 3 0\n" +
"7 0 2 0\n" +
"9 1 0 1\n" +
"2 0 0 2\n" +
"2 3 3 0\n" +
"2 2 2 3\n" +
"4 2 3 3\n" +
"7 3 1 3\n" +
"9 3 1 1\n" +
"8 1 2 2\n" +
"2 0 3 1\n" +
"2 1 0 0\n" +
"2 0 2 3\n" +
"11 0 1 1\n" +
"7 1 2 1\n" +
"9 2 1 2\n" +
"8 2 2 1\n" +
"7 1 0 2\n" +
"11 2 0 2\n" +
"2 2 3 3\n" +
"4 2 3 0\n" +
"7 0 3 0\n" +
"9 0 1 1\n" +
"8 1 2 0\n" +
"7 3 0 1\n" +
"11 1 3 1\n" +
"7 0 0 3\n" +
"11 3 1 3\n" +
"11 3 1 2\n" +
"7 2 2 2\n" +
"7 2 3 2\n" +
"9 2 0 0\n" +
"8 0 2 1\n" +
"2 1 0 0\n" +
"7 3 0 2\n" +
"11 2 2 2\n" +
"2 0 1 3\n" +
"8 0 2 0\n" +
"7 0 3 0\n" +
"9 0 1 1\n" +
"8 1 0 0\n" +
"7 2 0 1\n" +
"11 1 2 1\n" +
"12 3 2 2\n" +
"7 2 3 2\n" +
"9 0 2 0\n" +
"7 2 0 1\n" +
"11 1 1 1\n" +
"2 3 1 2\n" +
"2 2 1 3\n" +
"7 1 2 2\n" +
"7 2 3 2\n" +
"7 2 2 2\n" +
"9 0 2 0\n" +
"2 0 2 3\n" +
"2 2 3 1\n" +
"2 3 2 2\n" +
"4 3 2 3\n" +
"7 3 3 3\n" +
"7 3 1 3\n" +
"9 0 3 0\n" +
"8 0 1 1\n" +
"2 0 1 2\n" +
"2 3 1 3\n" +
"2 2 3 0\n" +
"5 3 0 3\n" +
"7 3 3 3\n" +
"9 3 1 1\n" +
"8 1 3 3\n" +
"2 1 3 0\n" +
"2 1 3 1\n" +
"7 1 0 2\n" +
"11 2 2 2\n" +
"8 0 2 2\n" +
"7 2 3 2\n" +
"9 3 2 3\n" +
"8 3 1 1\n" +
"2 1 2 3\n" +
"2 3 0 2\n" +
"9 3 0 3\n" +
"7 3 2 3\n" +
"9 3 1 1\n" +
"2 0 3 3\n" +
"2 2 2 0\n" +
"6 0 2 0\n" +
"7 0 2 0\n" +
"9 1 0 1\n" +
"2 3 3 0\n" +
"2 2 3 3\n" +
"7 3 1 3\n" +
"9 1 3 1\n" +
"8 1 0 0";
        ArrayList<Integer> arr = new ArrayList(Arrays.asList(0,0,0,0));
        for(String str : temp.split("\n")){
            int opcode = Integer.parseInt(str.split(" ")[0]);
            int A = Integer.parseInt(str.split(" ")[1]);
            int B = Integer.parseInt(str.split(" ")[2]);
            int C = Integer.parseInt(str.split(" ")[3]);
            switch(opcode){
                case 9://addr
                    arr.set(C, arr.get(A)+arr.get(B));
                    break;
                case 11://addi
                    arr.set(C, arr.get(A)+B);
                    break;
                case 15://mulr
                    arr.set(C, arr.get(A)*arr.get(B));
                    break;
                case 7://muli
                    arr.set(C, arr.get(A)*B);
                    break;
                case 5://banr
                    arr.set(C, arr.get(A)&arr.get(B));
                    break;
                case 1://bani
                    arr.set(C, arr.get(A)&B);
                    break;
                case 6://borr
                    arr.set(C, arr.get(A)|arr.get(B));
                    break;
                case 3://bori
                    arr.set(C, arr.get(A)|B);
                    break;
                case 8://setr
                    arr.set(C, arr.get(A));
                    break;
                case 2://seti
                    arr.set(C, A);
                    break;
                case 12://gtir
                    if(A > arr.get(B))
                        arr.set(C, 1);
                    else
                        arr.set(C, 0);
                    break;
                case 14://gtri
                    if(arr.get(A) > B)
                        arr.set(C, 1);
                    else
                        arr.set(C, 0);
                    break;
                case 13://gtrr
                    if(arr.get(A) > arr.get(B))
                        arr.set(C, 1);
                    else
                        arr.set(C, 0);
                    break;
                case 4://eqir
                    if(A == arr.get(B))
                        arr.set(C, 1);
                    else
                        arr.set(C, 0);
                    break;
                case 0://eqri
                    if(arr.get(A) == B)
                        arr.set(C, 1);
                    else
                        arr.set(C, 0);
                    break;
                case 10://eqrr
                    if(arr.get(A) == arr.get(B))
                        arr.set(C, 1);
                    else
                        arr.set(C, 0);
                    break;
            }
        }
        System.out.println(arr.get(0));
    }
}
